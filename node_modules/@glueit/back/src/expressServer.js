const express = require('express')
const expressHarness = require('./expressHarness')
const storeConfig = require('./storeConfig')
const storeInit = require('./storeInit')

const port = 3000
const app = express()

module.exports = async () => {
  const config = await storeConfig()
  storeInit(config)

  app.use(expressHarness({ api: config.api }))

  app.listen(port, () => {
    console.log(`listening on port: ${port}`)
  })
}
